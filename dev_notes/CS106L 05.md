# CS106L 05

æˆ‘çœ‹çš„ [video](https://www.bilibili.com/video/BV1K8411b7AU/?p=9) æ˜¯ 2020 winter å½•åˆ¶çš„ï¼Œä¼¼ä¹è¿™ä¸ªåˆé›†æ—¢æœ‰ 2020 åˆæœ‰ 2019 çš„å½•åˆ¶è§†é¢‘

## Algorithm

the STL algorithm library has a highly optimized version of what we wrotes

```c++
std::count
std::count_if
```

Algorithm we will explore!

- `std::sort`

  ```c++
  std::sort(container.begin(), container.end(), /*optional*/ compare_lambda_function)
  ```

- `std::nth_element`

  ç”¨äºå¯»æ‰¾ç¬¬ n ä¸ª elementï¼Œæ—¶é—´å¤æ‚åº¦ O(N)

  ```c++
  std::nth_element(v.begin(), v.begin() + n, v.end())
  ```

  è¯¥æ–¹æ³•ä¼šå¯¹å…ƒç´ è¿›è¡Œé‡æ–°æ’å¸ƒï¼Œæ’åºè¿‡åçš„ç¬¬ n ä¸ªå…ƒç´ ï¼Œå°±æ˜¯ container ä¸­ç¬¬ n å¤§çš„å…ƒç´ ã€‚ä»…ä¿è¯ç¬¬ n å¤§çš„å…ƒç´ åœ¨ç¬¬ n ä¸ªä½ç½®ï¼Œä¸ä¿è¯å…¶ä»–å…ƒç´ æ˜¯æŒ‰ç…§é¡ºåºæ’å¸ƒçš„

- `std::stable_partition`

  æ ¹æ®æ¡ä»¶å°† container åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œæ»¡è¶³æ¡ä»¶çš„åœ¨å‰åŠéƒ¨åˆ†ï¼Œä¸æ»¡è¶³çš„åœ¨ååŠéƒ¨åˆ†ï¼Œå¹¶ä¸” relative order ä¿æŒä¸å˜

  ```c++
  std::stable_partition(v.begin(), v.end(), condition_lambda_function)
  ```

- `std::copy_if`

  copy if å°†ä¸€ä¸ª vector ä¸­æ»¡è¶³æ¡ä»¶çš„å…ƒç´ æ‹·è´åˆ°å¦ä¸€ä¸ª vector å½“ä¸­ã€‚åœ¨æ‹·è´çš„è¿‡ç¨‹ä¸­ï¼Œè¦æ±‚å¦ä¸€ä¸ª vector æ˜¯å¯æ‰©å±•çš„ï¼Œå› ä¸ºå½“æ‹·è´å…ƒç´ æ•°é‡è¶…è¿‡äº† vector çš„å®¹é‡å°±ä¼šå¼•å‘é”™è¯¯ã€‚**äºæ˜¯å°±éœ€è¦ interator adapter**ï¼Œè¿™æ˜¯ç¬¬ä¸€æ¬¡åœ¨è¯¾ç¨‹ä¸­æåˆ°æ­¤æ¦‚å¿µ

  ![image-20240525172758031](CS106L 05/image-20240525172758031.png)

  ```c++
  std::copy_if(vec1.begin(), vec1.end(), std::back_inserter(vec2), condition_labmda_func)
  ```

  æ­¤æ—¶ `vec2` æœ€å¥½æ˜¯ä¸€ä¸ª empty containerï¼Œä¸ç„¶ä¼šç›´æ¥åœ¨ `vec2` æœ«å°¾è¿›è¡Œ copy [geeks](https://www.geeksforgeeks.org/stdback_inserter-in-cpp/)

  è¯¾ç¨‹è¿˜ä¸¾äº†ä¸€ä¸ªä¾‹å­ï¼Œä½¿ç”¨ `std::copy` æ¥å°†æ•°æ®å¤åˆ¶åˆ° output stream å½“ä¸­ï¼Œæˆ‘è¿™é‡Œè¯¢é—®äº†ä¸€ä¸‹ chatGPTï¼Œå› ä¸ºæˆ‘ä¸å¤ªç†è§£ä½¿ç”¨ `std::ostream_iterator<Course>` æ˜¯ä»€ä¹ˆæ„æ€ï¼Œçœ‹æ¥ `Cousre` å®ç°äº†è‡ªå·±çš„ stream è¾“å‡ºæ–¹å¼ï¼Œ`ostream_iterator` ä¹Ÿæ˜¯ä¸€ç§ adapter

  ```c++
  #include <iostream>
  #include <vector>
  #include <algorithm>
  #include <iterator>
  
  // Example definition of the Course struct
  struct Course {
      std::string name;
      int credits;
  
      // Overloading the stream insertion operator
      friend std::ostream& operator<<(std::ostream& os, const Course& course) {
          os << "Course Name: " << course.name << ", Credits: " << course.credits;
          return os;
      }
  };
  
  int main() {
      std::vector<Course> vec = {
          {"Math", 3},
          {"History", 4},
          {"Science", 5}
      };
  
      // The code snippet in question
      std::copy(vec.begin(), vec.end(), std::ostream_iterator<Course>(std::cout, "\n"));
  
      return 0;
  }
  ```

- `std::remove_if`

  remove does not change the size of vector, just move the element to the back of the vector!

  å¦‚æœçœŸçš„è¦ Removeï¼Œåˆ™è¦ä½¿ç”¨ `vector.erase`

- `std::find`

  æŸ¥æ‰¾åœ¨ vector ä¸­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ ï¼Œè¿”å›ä¸€ä¸ª iterator

  ```c++
  auto iter = std::find(vec.begin(), vec.end(), value);
  if (if != vec.end()) {
      std::cout << "Found: " << *iter << std::endl;
  }
  ```

é™¤æ­¤ä¹‹å¤–æˆ‘è¿˜æŸ¥è¯¢äº†ä¸€ä¸‹ï¼Œå¦‚ä½•å°†ä¸€ä¸ª lambda funtion ä½œä¸º parameter è¾“å…¥åˆ°å‡½æ•°å½“ä¸­

```c++
#include <iostream>
#include <functional>  // For std::function
// This function takes a lambda (or any callable) that returns void and takes an int
void applyToNumber(int num, std::function<void(int)> func) {
    func(num);  // Call the lambda with num as the argument
}
```

## Wrapping up the STL

Game Plan

- STL Conslusion
- Let's put it all together!

åŠ©æ•™ç®€å•å¯¹ä¹‹å‰çš„å†…å®¹è¿›è¡Œäº†æ€»ç»“ï¼Œçœ‹æ¥æˆ‘æ²¡æœ‰ä»»ä½•å†…å®¹ğŸ˜

<img src="CS106L 05/image-20240525200343968.png" alt="image-20240525200343968" style="zoom:80%;" />

é™¤äº†ä¸Šè¯¾ä»‹ç»çš„ library ä¹‹å¤–è¿˜æœ‰å¾ˆå¤šæœ‰ç”¨çš„ library:

- regex library
- multi-processing
- boost, linear algebra, not part of STL, but extremely useful

åˆ†å‰²çº¿---

- Abstraction in STL

  é¦–å…ˆä»‹ç»äº†ä¸€ä¸‹â€æŠ½è±¡â€œ çš„ä½œç”¨ï¼šèƒ½å¤Ÿè§£å†³ä¸€ç±»é—®é¢˜ï¼Œè€Œä¸å…³å¿ƒå…·ä½“çš„å®ç°

  åœ¨ STL ä¸­æœ‰å¤šå±‚æŠ½è±¡ï¼š

  1. Containers can abstract away basic types, å¯ä»¥æ¥å—å„ç§å„æ ·çš„æ•°æ®ç±»å‹
  2. Iterator can abstract away container typesï¼Œå¯ä»¥æ“ä½œä¸åŒçš„ container
  3. Algorithms can abstract awary iterator types, å¯ä»¥æ“ä½œä¸åŒçš„ iterator

  template ä¹Ÿæ˜¯ abstraction å½“ä¸­çš„ä¸€ç§

  æ­¤æ—¶ï¼ŒåŠ©æ•™å‘å‡ºè´ºç”µï¼Congratulations! æ­å–œå®Œæˆäº† C++ å­¦ä¹ çš„ä¸€å¤§æ­¥ï¼

  <img src="CS106L 05/image-20240525201300774.png" alt="image-20240525201300774" style="zoom:33%;" />

- æœ‰åŒå­¦é—®ï¼šä¸ºä»€ä¹ˆ STL ä½¿ç”¨çš„æ˜¯ `std` ä½œä¸º namespaceï¼Œè€Œä¸æ˜¯ `stl` ğŸ¤£ç¡®å®ï¼

- åŠ©æ•™è¯´äº†ä¸€ä¸ªæ¸¸æˆï¼šWikiRace! é‚£å°±æ˜¯åªé€šè¿‡ wikepedia çš„é“¾æ¥å»è·³è½¬åˆ°æŒ‡å®šçš„ç½‘ç«™ï¼Œè€Œä¸æ˜¯é€šè¿‡æœç´¢å¼•æ“ğŸ¤”æœ‰ç‚¹æç¬‘å“ˆå“ˆå“ˆï¼Œä½†ä¸æ˜¯ç™½ä»‹ç»è¿™ä¸ªæ¸¸æˆï¼Œè€Œæ˜¯è¦é€šè¿‡ä»£ç å»å®Œæˆè¿™ä¸ªåŠŸèƒ½ï¼è¿™æ˜¯ Assignment 2 

- Lol è¿™è¯¾è¶Šæ¥è¶Šå¥½ç¬‘äº†ï¼ŒåŠ©æ•™åˆå‘å¸ƒäº†ä¸€ä¸ªä»»åŠ¡ï¼šå¦‚ä½•é€šè¿‡æ–‡å­—æ¥åˆ¤æ–­ï¼Œè¿™æ˜¯è°å†™çš„å†…å®¹ã€‚æœ‰äººè¯´ï¼šé€šè¿‡æ–‡å­—é¢‘ç‡æ¥åˆ†æ writing style ï¼ŒåŠ©æ•™ï¼šgoodï¼›æœ‰äººè¯´ï¼šmachine learningï¼ŒåŠ©æ•™ï¼šthank you, the class is overğŸ˜‚just kidding

- Let's get coding!!!

  How to write a program from scratch?

  `std::transform` ç±»ä¼¼äº python ä¸­çš„ `map`ï¼Œä¼šå°† function æ˜ å°„åˆ° container ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œç„¶åä½¿ç”¨æ–°çš„ container `dest` æ¥ä¿å­˜

  ```c++
  std::transform(iter.begin(), iter.end(), dest.begin(), function)
  ```

  åŠ©æ•™åªæ˜¯æŠŠæ•´ä¸ªä»£ç çš„æ¡†æ¶ä»¥åŠå¦‚ä½•è¯»å–æ–‡ä»¶å†™å‡ºæ¥äº†ï¼Œéœ€è¦è‡ªå·±å®Œæˆå‰©ä¸‹çš„ä»£ç 

  ç”šè‡³ç•™ä¸‹äº†æ‚¬å¿µï¼ä½¿ç”¨ä»€ä¹ˆå»æ›¿ä»£ `std::count` æ¥ç»Ÿè®¡å‡ºç°çš„æ¬¡æ•°ï¼Œå› ä¸ºä½¿ç”¨ `std::count` ä¼šå‡ºç°é—®é¢˜ï¼šå› ä¸ºå®ƒæ˜¯å»å¯»æ‰¾ container ä¸­å•ä¸ª item å‡ºç°çš„ä¸ªæ•°ã€‚æ ¹æ® [github](https://github.com/averywang21/CS106L-spr20) ä¸Šçš„ä»£ç æ¥çœ‹ï¼Œæ˜¯ä½¿ç”¨äº† `std::search` çš„æ–¹å¼æ¥å®Œæˆå­ä¸²çš„æœç´¢

  ```c++
  std::search(iter.begin(), iter.end(), sub_str.begin(), sub_str.end())
  ```
  
  æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥æ ¹æ® `std::string::find` çš„æ–¹æ³•ç›´æ¥æœç´¢å­ä¸²ä½ç½®ï¼Œç„¶åè¿­ä»£å‘å‰
  
- 13:00 åŠ©æ•™åœ¨ ep 11 ä¸­å®ç°äº†å®Œæ•´çš„åŠŸèƒ½ï¼Œå…¶ä¸­è¿˜ä½¿ç”¨äº†ä¸€ä¸ªæ–°çš„ library `numeric`ï¼Œè°ƒç”¨äº†å…¶ä¸­çš„ `inner_product`ï¼Œè¿™ä¹Ÿæ˜¯ STL ä¸­çš„å…¶ä¸­ä¸€ä¸ªã€‚åœ¨å†™ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä½ ä¸çŸ¥é“æŸä¸ªå‡½æ•°æ¥è‡ªå“ªä¸ª libraryï¼Œåªæœ‰æ‰‹åŠ¨ google ä¸€ä¸‹ cpp referenceï¼Œcpp reference æ˜¯çœŸçš„æœ‰ç”¨

## Question

- æˆ‘å‘ç°æˆ‘åœ¨å¾€å›å¤ä¹ çš„æ—¶å€™ï¼Œæƒ³è¦å¯»æ‰¾è§†é¢‘ä¸­å¯¹åº”çš„éƒ¨åˆ†ï¼Œè¿™ä¼šå¾ˆèŠ±è´¹æ—¶é—´ğŸ¤”ä¹‹åè®°å½•çš„æ—¶å€™åº”è¯¥è¦è€ƒè™‘åŠ ä¸Šè§†é¢‘çš„æ—¶é—´æˆ³

