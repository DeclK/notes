# AW Experiment

## 实验结果 test split

1. CenterPoint Baseline

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |64.62       |73.10       |43.15       |12.80       |
   |Bus         |58.88       |66.18       |59.63       |13.64       |
   |Pedestrian  |52.69       |55.93       |42.73       |5.24        |
   |Cyclist     |48.74       |50.53       |44.21       |28.64       |
   |mAP         |56.23       |61.43       |47.43       |15.08       |
   ```

2. IoU rectification $\lambda=0.5$

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |66.21       |74.85       |45.54       |14.94       |
   |Bus         |61.01       |68.67       |60.04       |14.57       |
   |Pedestrian  |56.85       |60.58       |44.99       |7.08        |
   |Cyclist     |53.40       |56.05       |47.09       |31.01       |
   |mAP         |59.37       |65.04       |49.41       |16.90       |
   ```

   经过搜索获得最好的表现

   ```txt
   RECTIFIER: [0.7, 0.67, 0.53, 0.65]
   
   # test split
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |66.55       |75.36       |45.35       |15.27       |
   |Bus         |61.24       |68.03       |59.54       |14.71       |
   |Pedestrian  |56.86       |60.48       |45.15       |7.33        |
   |Cyclist     |53.84       |56.77       |46.49       |30.36       |
   |mAP         |59.62       |65.16       |49.13       |16.92       |
   
   # validation split
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |65.59       |72.42       |44.75       |25.54       |
   |Bus         |58.57       |69.33       |47.44       |17.86       |
   |Pedestrian  |65.45       |70.23       |26.58       |1.39        |
   |Cyclist     |47.82       |50.88       |36.73       |16.70       |
   |mAP         |59.36       |65.71       |38.87       |15.37       |
   ```

3. IoU regression 几乎没有提升

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |65.11       |73.75       |44.48       |13.12       |
   |Bus         |60.51       |67.70       |60.55       |12.83       |
   |Pedestrian  |53.23       |56.29       |43.85       |9.30        |
   |Cyclist     |49.14       |50.74       |43.74       |32.11       |
   |mAP         |57.00       |62.12       |48.16       |16.84       |
   ```

4. CGAM 加入后反而掉点，特别是 cyclist

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |64.22       |72.49       |43.15       |12.51       |
   |Bus         |59.98       |67.19       |59.22       |12.97       |
   |Pedestrian  |52.69       |56.01       |41.33       |8.72        |
   |Cyclist     |44.71       |46.49       |41.79       |29.70       |
   |mAP         |55.40       |60.55       |46.37       |15.97       |
   ```

6. iou + cgam v2 centerpoint single head，行人掉点，其他均有提升，如果调整一下 rectifier 应该能够达到 59.95 

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |67.14       |75.77       |45.93       |15.28       |
   |Bus         |62.72       |69.85       |61.38       |15.99       |
   |Pedestrian  |53.90       |56.73       |45.59       |11.18       |
   |Cyclist     |55.42       |58.56       |46.30       |32.50       |
   |mAP         |59.79       |65.23       |49.80       |18.74       |
   ```

7. iou debug version, modify bev backbone and post processing

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |66.56       |75.95       |42.72       |15.30       |
   |Bus         |60.62       |68.01       |58.72       |17.58       |
   |Pedestrian  |55.72       |58.33       |48.08       |12.27       |
   |Cyclist     |53.80       |56.75       |45.42       |29.57       |
   |mAP         |59.18       |64.76       |48.73       |18.68       |
   ```

8. iou multi-head

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |67.02       |77.05       |44.34       |17.33       |
   |Bus         |60.47       |66.51       |62.08       |16.50       |
   |Pedestrian  |55.76       |59.16       |45.11       |13.52       |
   |Cyclist     |51.95       |55.42       |41.52       |32.91       |
   |mAP         |58.80       |64.54       |48.26       |20.07       |
   ```

9. iou multi-head lr 0.001, epoch 160

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |67.06       |76.84       |45.71       |13.62       |
   |Bus         |61.44       |68.91       |59.39       |13.52       |
   |Pedestrian  |57.47       |61.09       |47.24       |12.96       |
   |Cyclist     |53.54       |56.91       |43.51       |36.35       |
   |mAP         |59.88       |65.94       |48.96       |19.11       |
   ```

## Val & Test

1. best val, iou + cgam + sc

   ```txt
   # val
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |64.93       |73.63       |40.09       |25.65       |
   |Bus         |55.91       |67.89       |44.72       |17.82       |
   |Cyclist     |50.74       |53.61       |36.11       |25.09       |
   |Pedestrian  |66.42       |73.50       |22.11       |0.30        |
   |mAP         |59.50       |67.16       |35.76       |17.22       |
   
   # test
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |67.26       |76.24       |42.81       |16.61       |
   |Bus         |62.05       |68.84       |61.08       |17.21       |
   |Cyclist     |53.21       |55.95       |45.89       |32.48       |
   |Pedestrian  |55.03       |57.55       |47.31       |12.77       |
   |mAP         |59.39       |64.64       |49.27       |19.77       |
   ```

2. iou multi-head + cgam，CGAM might better also use multi-head

   ```txt
   # val
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |66.19       |73.08       |45.18       |28.94       |
   |Bus         |56.09       |66.58       |45.62       |17.76       |
   |Cyclist     |47.28       |49.92       |36.68       |17.34       |
   |Pedestrian  |64.75       |70.34       |26.36       |0.90        |
   |mAP         |58.58       |64.98       |38.46       |16.23       |
   
   # test
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |66.74       |77.04       |43.00       |14.40       |
   |Bus         |61.92       |69.67       |59.25       |13.67       |
   |Cyclist     |52.27       |55.93       |41.27       |26.58       |
   |Pedestrian  |56.04       |59.49       |45.77       |13.59       |
   |mAP         |59.24       |65.53       |47.32       |17.06       |
   ```

3. iou

   ```txt
   # val
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |64.79       |73.00       |42.58       |26.95       |
   |Bus         |55.75       |64.86       |45.39       |22.30       |
   |Cyclist     |47.96       |50.55       |38.69       |20.28       |
   |Pedestrian  |63.60       |70.14       |23.79       |2.56        |
   |mAP         |58.03       |64.64       |37.61       |18.02       |
   
   # test anomoly too high
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |67.06       |76.84       |45.71       |13.62       |
   |Bus         |61.44       |68.91       |59.39       |13.52       |
   |Cyclist     |53.54       |56.91       |43.51       |36.35       |
   |Pedestrian  |57.47       |61.09       |47.24       |12.96       |
   |mAP         |59.88       |65.94       |48.96       |19.11       |
   
   # calibrate val
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |65.52       |72.42       |45.08       |26.28       |
   |Bus         |56.99       |67.42       |46.38       |17.08       |
   |Cyclist     |47.82       |50.84       |40.04       |17.16       |
   |Pedestrian  |64.07       |71.17       |24.01       |1.83        |
   |mAP         |58.60       |65.46       |38.88       |15.59       |
   
   # calibrate test
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |66.98       |76.90       |44.51       |14.67       |
   |Bus         |61.28       |66.84       |61.87       |18.50       |
   |Cyclist     |51.98       |55.57       |40.78       |32.38       |
   |Pedestrian  |56.64       |60.08       |46.56       |11.04       |
   |mAP         |59.22       |64.85       |48.43       |19.15       |
   ```

## Test2

1. iou multi-head lr 0.001, epoch 160

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |64.76       |77.64       |46.75       |25.65       |
   |Bus         |55.08       |60.51       |53.52       |38.06       |
   |Pedestrian  |32.98       |36.96       |27.72       |8.17        |
   |Cyclist     |56.52       |67.92       |35.66       |15.17       |
   |mAP         |52.33       |60.76       |40.91       |21.76       |
   ```

2. iou multi-head

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |65.02       |78.74       |47.69       |25.55       |
   |Bus         |53.65       |61.92       |48.28       |42.69       |
   |Pedestrian  |37.06       |41.81       |29.62       |15.05       |
   |Cyclist     |54.22       |64.10       |36.03       |14.27       |
   |mAP         |52.49       |61.64       |40.40       |24.39       |
   
   # calibrate
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |64.73       |77.49       |47.26       |25.46       |
   |Bus         |54.89       |61.62       |49.72       |48.32       |
   |Cyclist     |54.80       |65.76       |35.18       |11.28       |
   |Pedestrian  |36.95       |42.15       |29.57       |10.08       |
   |mAP         |52.85       |61.76       |40.43       |23.78       |
   ```

3. iou aux

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |66.80       |77.88       |51.46       |34.24       |
   |Bus         |53.98       |61.87       |50.30       |40.03       |
   |Pedestrian  |33.82       |37.17       |30.39       |10.96       |
   |Cyclist     |55.55       |65.48       |38.72       |15.98       |
   |mAP         |52.54       |60.60       |42.72       |25.30       |
   ```

4. iou single head

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |67.27       |79.95       |50.36       |33.42       |
   |Bus         |54.02       |63.93       |47.85       |41.81       |
   |Pedestrian  |32.19       |34.48       |31.03       |17.44       |
   |Cyclist     |54.80       |65.07       |37.45       |15.52       |
   |mAP         |52.07       |60.86       |41.67       |27.05       |
   ```

## Half Dataset Experiment

1. Half centerpoint baseline

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |59.89       |68.45       |40.16       |13.17       |
   |Bus         |54.84       |62.28       |51.04       |14.38       |
   |Pedestrian  |41.72       |42.26       |42.21       |7.69        |
   |Cyclist     |45.69       |46.47       |45.39       |28.74       |
   |mAP         |50.53       |54.87       |44.70       |16.00       |
   ```
   
2. CGAM Repv2 centerpoint single head

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |62.31       |71.05       |40.91       |14.95       |
   |Bus         |56.33       |64.31       |51.20       |18.24       |
   |Pedestrian  |45.25       |46.67       |43.24       |11.70       |
   |Cyclist     |45.51       |46.51       |45.82       |34.20       |
   |mAP         |52.35       |57.13       |45.29       |19.77       |
   ```

3. SC-Conv class agnostic

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |62.65       |71.44       |42.22       |14.48       |
   |Bus         |58.16       |65.80       |52.86       |15.08       |
   |Pedestrian  |42.51       |43.53       |41.11       |9.13        |
   |Cyclist     |42.61       |44.27       |38.95       |30.43       |
   |mAP         |51.48       |56.26       |43.79       |17.28       |
   ```

## 历史模型

```txt
|AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
|Car         |67.49       |76.69       |52.13       |2.86        |
|Bus         |68.75       |78.98       |74.07       |7.12        |
|Cyclist     |70.33       |73.62       |43.44       |0.00        |
|Pedestrian  |61.47       |63.21       |47.91       |58.80       |
|mAP         |67.01       |73.13       |54.39       |17.19       |
```

历史模型新测试集上的表现

```txt
|AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
|Car         |58.65       |76.20       |32.42       |12.95       |
|Bus         |38.53       |54.29       |30.59       |8.28        |
|Cyclist     |43.59       |56.29       |20.78       |5.26        |
|Pedestrian  |20.77       |20.78       |24.92       |4.31        |
|mAP         |40.38       |51.89       |27.18       |7.70        |

# old val and test 
|AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
|Car         |69.21       |79.15       |45.91       |16.81       |
|Bus         |72.35       |83.09       |67.79       |18.73       |
|Cyclist     |58.54       |65.35       |36.53       |10.78       |
|Pedestrian  |61.43       |66.53       |45.76       |26.90       |
|mAP         |65.38       |73.53       |49.00       |18.31       |

|AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
|Car         |66.62       |75.22       |48.34       |21.86       |
|Bus         |68.42       |79.56       |67.41       |19.69       |
|Cyclist     |53.16       |55.60       |41.07       |9.01        |
|Pedestrian  |63.00       |64.81       |57.82       |3.04        |
|mAP         |62.80       |68.80       |53.66       |13.40       |
```

当前模型在新测试集上的表现，比历史模型好得多，说明之前的模型过拟合了





