# AW Experiment

## 实验结果

1. CenterPoint Baseline

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |64.62       |73.10       |43.15       |12.80       |
   |Bus         |58.88       |66.18       |59.63       |13.64       |
   |Pedestrian  |52.69       |55.93       |42.73       |5.24        |
   |Cyclist     |48.74       |50.53       |44.21       |28.64       |
   |mAP         |56.23       |61.43       |47.43       |15.08       |
   ```

   **比历史模型指标低很多，正在排查数据问题?**

2. IoU rectification $\lambda=0.5$

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |66.21       |74.85       |45.54       |14.94       |
   |Bus         |61.01       |68.67       |60.04       |14.57       |
   |Pedestrian  |56.85       |60.58       |44.99       |7.08        |
   |Cyclist     |53.40       |56.05       |47.09       |31.01       |
   |mAP         |59.37       |65.04       |49.41       |16.90       |
   ```

   经过搜索获得最好的表现

   ```txt
   RECTIFIER: [0.7, 0.67, 0.53, 0.65]
   
   # test split
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |66.55       |75.36       |45.35       |15.27       |
   |Bus         |61.24       |68.03       |59.54       |14.71       |
   |Pedestrian  |56.86       |60.48       |45.15       |7.33        |
   |Cyclist     |53.84       |56.77       |46.49       |30.36       |
   |mAP         |59.62       |65.16       |49.13       |16.92       |
   
   # validation split
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |65.59       |72.42       |44.75       |25.54       |
   |Bus         |58.57       |69.33       |47.44       |17.86       |
   |Pedestrian  |65.45       |70.23       |26.58       |1.39        |
   |Cyclist     |47.82       |50.88       |36.73       |16.70       |
   |mAP         |59.36       |65.71       |38.87       |15.37       |
   
   # rectify at dense level then use nms
   # need to grid search it again! & tune class specific score thresh
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |66.46       |75.85       |42.66       |15.24       |
   |Bus         |60.47       |67.86       |59.03       |17.56       |
   |Pedestrian  |55.43       |58.09       |47.21       |12.11       |
   |Cyclist     |53.94       |56.92       |45.50       |29.38       |
   |mAP         |59.08       |64.68       |48.60       |18.57       |
   ```

3. IoU regression 几乎没有提升，可能需要尝试不同的损失函数例如 GIoU?

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |65.11       |73.75       |44.48       |13.12       |
   |Bus         |60.51       |67.70       |60.55       |12.83       |
   |Pedestrian  |53.23       |56.29       |43.85       |9.30        |
   |Cyclist     |49.14       |50.74       |43.74       |32.11       |
   |mAP         |57.00       |62.12       |48.16       |16.84       |
   ```

4. CGAM 加入后反而掉点，特别是 cyclist

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |64.22       |72.49       |43.15       |12.51       |
   |Bus         |59.98       |67.19       |59.22       |12.97       |
   |Pedestrian  |52.69       |56.01       |41.33       |8.72        |
   |Cyclist     |44.71       |46.49       |41.79       |29.70       |
   |mAP         |55.40       |60.55       |46.37       |15.97       |
   ```

5. CGAM 模块目前作用不大，不过找到了和 IoU 类似的修正方法，也能提点

## Half Dataset Experiment

1. Half centerpoint baseline

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |59.89       |68.45       |40.16       |13.17       |
   |Bus         |54.84       |62.28       |51.04       |14.38       |
   |Pedestrian  |41.72       |42.26       |42.21       |7.69        |
   |Cyclist     |45.69       |46.47       |45.39       |28.74       |
   |mAP         |50.53       |54.87       |44.70       |16.00       |
   
   # class specific nms, score thresh = 0.2
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |60.35       |68.56       |38.30       |21.56       |
   |Bus         |53.31       |64.51       |38.85       |15.69       |
   |Pedestrian  |55.49       |58.62       |23.63       |0.33        |
   |Cyclist     |36.22       |36.72       |33.96       |25.10       |
   |mAP         |51.34       |57.10       |33.68       |15.67       |
   ```

2. CGAM Repv2

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |62.31       |71.05       |40.91       |14.95       |
   |Bus         |56.33       |64.31       |51.20       |18.24       |
   |Pedestrian  |45.25       |46.67       |43.24       |11.70       |
   |Cyclist     |45.51       |46.51       |45.82       |34.20       |
   |mAP         |52.35       |57.13       |45.29       |19.77       |
   ```

3. SC-Conv class agnostic

   ```txt
   |AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
   |Car         |62.94       |71.83       |41.71       |12.99       |
   |Bus         |57.43       |64.12       |55.20       |13.27       |
   |Pedestrian  |40.79       |43.54       |33.12       |5.37        |
   |Cyclist     |43.94       |45.37       |42.18       |27.40       |
   |mAP         |51.28       |56.22       |43.05       |14.76       |
   ```

## 历史模型

```txt
|AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
|Car         |67.49       |76.69       |52.13       |2.86        |
|Bus         |68.75       |78.98       |74.07       |7.12        |
|Cyclist     |70.33       |73.62       |43.44       |0.00        |
|Pedestrian  |61.47       |63.21       |47.91       |58.80       |
|mAP         |67.01       |73.13       |54.39       |17.19       |
```

历史模型在当下验证集的表现

```txt
|AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
|Car         |66.62       |75.22       |48.34       |21.86       |
|Bus         |68.42       |79.56       |67.41       |19.69       |
|Cyclist     |53.16       |55.60       |41.07       |9.01        |
|Pedestrian  |63.00       |64.81       |57.82       |3.04        |
|mAP         |62.80       |68.80       |53.66       |13.40       |
```

历史模型新测试集上的表现

```txt
|AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
|Car         |58.65       |76.20       |32.42       |12.95       |
|Bus         |38.53       |54.29       |30.59       |8.28        |
|Cyclist     |43.59       |56.29       |20.78       |5.26        |
|Pedestrian  |20.77       |20.78       |24.92       |4.31        |
|mAP         |40.38       |51.89       |27.18       |7.70        |

# val or test?
|AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
|Car         |69.21       |79.15       |45.91       |16.81       |
|Bus         |72.35       |83.09       |67.79       |18.73       |
|Cyclist     |58.54       |65.35       |36.53       |10.78       |
|Pedestrian  |61.43       |66.53       |45.76       |26.90       |
|mAP         |65.38       |73.53       |49.00       |18.31       |
```

当前模型在新测试集上的表现，比历史模型好得多，说明之前的模型过拟合了

```txt
|AP@50       |overall     |0-30m       |30-50m      |50m-inf     |
|Car         |67.27       |79.95       |50.36       |33.42       |
|Bus         |54.02       |63.93       |47.85       |41.81       |
|Pedestrian  |32.19       |34.48       |31.03       |17.44       |
|Cyclist     |54.80       |65.07       |37.45       |15.52       |
|mAP         |52.07       |60.86       |41.67       |27.05       |
```



